# ğŸš€ PassGFW

è·¨å¹³å°é˜²ç«å¢™æ£€æµ‹å’ŒæœåŠ¡å™¨å¯ç”¨æ€§æ£€æŸ¥åº“ï¼Œæ”¯æŒ iOSã€macOSã€Android å’Œ HarmonyOSã€‚

**è½»é‡çº§ â€¢ å®‰å…¨ â€¢ é«˜æ€§èƒ½ â€¢ çº¯åŸç”Ÿ**

---

## ğŸ“– æ¦‚è¿°

PassGFW å¸®åŠ©åº”ç”¨é€šè¿‡æµ‹è¯•å¤šä¸ªæœåŠ¡å™¨ç«¯ç‚¹ï¼ˆä½¿ç”¨ RSA åŠ å¯†å’Œç­¾åéªŒè¯ï¼‰æ¥ç»•è¿‡é˜²ç«å¢™é™åˆ¶ã€‚

**æ ¸å¿ƒç‰¹æ€§ï¼š**
- ğŸ” **RSA 2048 ä½åŠ å¯†** - OAEPåŠ å¯† + PSSç­¾å
- ğŸŒ **å¤šå¹³å°æ”¯æŒ** - iOSã€macOSã€Androidã€HarmonyOS
- ğŸ“± **çº¯åŸç”Ÿå®ç°** - Swiftã€Kotlinã€ArkTSï¼Œæ— è·¨è¯­è¨€æ¡¥æ¥
- ğŸ”„ **ç®€å•å¯é ** - ä¸²è¡Œæ£€æµ‹ + æ— é™é‡è¯• + å†…å­˜ç¼“å­˜
- ğŸ’¾ **åŠ¨æ€URLç®¡ç†** - store/removeæ–¹æ³•æ”¯æŒè¿è¡Œæ—¶æ·»åŠ åˆ é™¤URL
- ğŸŒ **Navigateæ–¹æ³•** - æ‰“å¼€æµè§ˆå™¨å¼•å¯¼ç”¨æˆ·
- ğŸª¶ **è½»é‡çº§** - æ ¸å¿ƒä»£ç  < 500è¡Œ/å¹³å°
- âš¡ **é«˜æ€§èƒ½GoæœåŠ¡å™¨** - Ginæ¡†æ¶ + å†…ç½®å¯†é’¥

---

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### è®¾è®¡åŸåˆ™

**æ¯ä¸ªå¹³å°ä½¿ç”¨åŸç”Ÿè¯­è¨€å®ç°ï¼Œé¿å…è·¨è¯­è¨€æ¡¥æ¥**

- **iOS/macOS**: Swift + Security.framework
- **Android**: Kotlin + Java Crypto
- **HarmonyOS**: ArkTS + @ohos.security.cryptoFramework

### é¡¹ç›®ç»“æ„

```
passgfw/
â”œâ”€â”€ clients/
â”‚   â”œâ”€â”€ ios-macos/              Swift å®ç° (~400è¡Œ)
â”‚   â”‚   â”œâ”€â”€ Package.swift
â”‚   â”‚   â”œâ”€â”€ Sources/PassGFW/
â”‚   â”‚   â””â”€â”€ Examples/
â”‚   â”‚
â”‚   â”œâ”€â”€ android/                Kotlin å®ç° (~500è¡Œ)
â”‚   â”‚   â”œâ”€â”€ passgfw/           Library
â”‚   â”‚   â””â”€â”€ app/               æµ‹è¯•APK
â”‚   â”‚
â”‚   â”œâ”€â”€ harmony/                ArkTS å®ç° (~500è¡Œ)
â”‚   â”‚   â””â”€â”€ entry/src/main/ets/passgfw/
â”‚   â”‚
â”‚   â””â”€â”€ build_config.json       æ„å»ºé…ç½®ï¼ˆURLs + å…¬é’¥ï¼‰
â”‚
â”œâ”€â”€ server/                     Go æœåŠ¡å™¨ (~300è¡Œ)
â”‚   â”œâ”€â”€ main.go
â”‚   â””â”€â”€ keys/
â”‚
â””â”€â”€ docs/                       æ–‡æ¡£
    â”œâ”€â”€ list_format_examples.md
    â””â”€â”€ SECURITY_AND_PERMISSIONS.md
```

---

## ğŸ”‘ æ ¸å¿ƒæ¦‚å¿µ

### 1. å•ä¸€APIè®¾è®¡

æ‰€æœ‰å¹³å°ç»Ÿä¸€ä½¿ç”¨ `getDomains(retry)` APIï¼š

```swift
// iOS/macOS
let result = await passgfw.getDomains(retry: false, customData: nil)
// è¿”å›: [String: Any]? åŒ…å«æœåŠ¡å™¨å“åº”æ•°æ®

// Android
val result = passgfw.getDomains(retry = false, customData = null)
// è¿”å›: Map<String, Any>?

// HarmonyOS
const result = await passgfw.getDomains(false, undefined);
// è¿”å›: ESObject?
```

**å‚æ•°è¯´æ˜ï¼š**
- `retry`:
  - `false` - å¦‚æœæœ‰ç¼“å­˜åˆ™è¿”å›ç¼“å­˜ï¼ˆé¦–æ¬¡æ£€æµ‹ï¼‰
  - `true` - å¼ºåˆ¶é‡æ–°æ£€æµ‹ï¼ˆåˆ·æ–°ï¼‰
- `customData`: å¯é€‰çš„è‡ªå®šä¹‰æ•°æ®å‘é€ç»™æœåŠ¡å™¨

### 2. URL Entry ç»“æ„

```typescript
interface URLEntry {
  method: "api" | "file" | "navigate" | "remove";
  url: string;
  store?: boolean;  // æ£€æµ‹æˆåŠŸåæ˜¯å¦æŒä¹…åŒ–ï¼ˆé»˜è®¤falseï¼‰
}
```

**Method ç±»å‹ï¼š**

- **`api`** - APIæ¥å£æ£€æµ‹
  - å®¢æˆ·ç«¯å‘é€åŠ å¯†çš„nonce + os + app + data
  - æœåŠ¡å™¨è¿”å›ç­¾åçš„å“åº”ï¼š`{nonce, data, urls, signature}`
  - éªŒè¯ç­¾ååè¿”å›`data`å­—æ®µï¼ˆmapï¼‰
  - **æˆåŠŸâ†’è¿”å›æ•°æ®ï¼Œå¤±è´¥â†’ç»§ç»­ä¸‹ä¸€ä¸ª**

- **`file`** - é™æ€æ–‡ä»¶åˆ—è¡¨
  - ä»URLè·å–æ›´å¤šURLEntryåˆ—è¡¨
  - æ”¯æŒé€’å½’ï¼ˆæœ€å¤§æ·±åº¦5ï¼‰
  - æ”¯æŒ*PGFW*æ ¼å¼éšè”½åµŒå…¥
  - **æˆåŠŸâ†’è¿”å›æ•°æ®ï¼Œå¤±è´¥â†’ç»§ç»­ä¸‹ä¸€ä¸ª**

- **`navigate`** - æ‰“å¼€æµè§ˆå™¨
  - åœ¨é»˜è®¤æµè§ˆå™¨æ‰“å¼€æŒ‡å®šURL
  - ç”¨äºå¼•å¯¼ç”¨æˆ·è®¿é—®å¸®åŠ©é¡µé¢
  - **æ‰§è¡Œåè¿”å›æˆåŠŸï¼ˆå·²å®Œæˆå¼•å¯¼ï¼Œä¸å†ç»§ç»­åç»­URLï¼‰**

- **`remove`** - åˆ é™¤URL
  - ä»æœ¬åœ°å­˜å‚¨åˆ é™¤æŒ‡å®šURL
  - ç”¨äºç§»é™¤å¤±æ•ˆçš„æœåŠ¡å™¨
  - **æ‰§è¡Œåç»§ç»­ä¸‹ä¸€ä¸ªï¼ˆç±»ä¼¼å¤±è´¥å¤„ç†ï¼‰**

**Store å±æ€§ï¼š**
- `store: true` - æ£€æµ‹æˆåŠŸåä¿å­˜åˆ°æœ¬åœ°ï¼Œä¸‹æ¬¡å¯åŠ¨è‡ªåŠ¨åŠ è½½
- `store: false` æˆ–çœç•¥ - ä¸´æ—¶ä½¿ç”¨ï¼Œä¸æŒä¹…åŒ–

---

## ğŸ§  é˜²ç«å¢™æ£€æµ‹é€»è¾‘ä¸æ€ç»´æ¨¡å¼

### æ ¸å¿ƒè®¾è®¡æ€è·¯

PassGFW çš„è®¾è®¡åŸºäºä¸€ä¸ªæ ¸å¿ƒæ€ç»´ï¼š**é¢å¯¹ä¸ç¡®å®šæ€§çš„ç½‘ç»œç¯å¢ƒï¼Œé€šè¿‡ç®€å•å¯é çš„ä¸²è¡Œæ£€æµ‹ + æ— é™é‡è¯•æ¥ä¿è¯æœ€ç»ˆæˆåŠŸ**ã€‚

#### ä¸ºä»€ä¹ˆé€‰æ‹©ä¸²è¡Œæ£€æµ‹è€Œä¸æ˜¯å¹¶å‘ï¼Ÿ

**æ€ç»´æ¨¡å¼ï¼šç¨³å®šæ€§ > é€Ÿåº¦**

```
å¹¶å‘æ£€æµ‹çš„é—®é¢˜ï¼š
âŒ åŒæ—¶å‘èµ·10ä¸ªè¯·æ±‚ â†’ é˜²ç«å¢™å¯èƒ½æ£€æµ‹åˆ°å¼‚å¸¸æµé‡
âŒ èµ„æºæ¶ˆè€—å¤§ â†’ ç§»åŠ¨è®¾å¤‡ç”µé‡å’Œæµé‡å‹åŠ›
âŒ å¤æ‚çš„çŠ¶æ€ç®¡ç† â†’ éœ€è¦å¤„ç†ç«æ€æ¡ä»¶ã€è¶…æ—¶æ§åˆ¶ã€ç»“æœåˆå¹¶
âŒ éš¾ä»¥è°ƒè¯• â†’ é—®é¢˜éš¾ä»¥é‡ç°

ä¸²è¡Œæ£€æµ‹çš„ä¼˜åŠ¿ï¼š
âœ… å•ä¸€æ—¶åˆ»åªæœ‰1ä¸ªè¯·æ±‚ â†’ æµé‡æ­£å¸¸ï¼Œä¸æ˜“è¢«æ£€æµ‹
âœ… èµ„æºæ¶ˆè€—å° â†’ ç§»åŠ¨è®¾å¤‡å‹å¥½
âœ… é€»è¾‘ç®€å•æ¸…æ™° â†’ æ˜“äºç»´æŠ¤å’Œè°ƒè¯•
âœ… å¯é¢„æµ‹æ€§å¼º â†’ é¡ºåºæ‰§è¡Œï¼Œè¡Œä¸ºæ˜ç¡®
```

**è®¾è®¡åŸåˆ™ï¼š** åœ¨å—é™çš„ç½‘ç»œç¯å¢ƒä¸­ï¼Œ"æ…¢è€Œç¨³"ä¼˜äº"å¿«ä½†ä¸ç¨³å®š"ã€‚

#### ä¸ºä»€ä¹ˆä½¿ç”¨æ— é™é‡è¯•ï¼Ÿ

**æ€ç»´æ¨¡å¼ï¼šæœ€ç»ˆä¸€è‡´æ€§**

```
åœºæ™¯åˆ†æï¼š
1. é˜²ç«å¢™çŸ­æš‚é˜»æ–­ â†’ 2ç§’åé‡è¯•å¯èƒ½å°±é€šäº†
2. ç½‘ç»œåˆ‡æ¢ï¼ˆWiFi â‡„ 4G/5Gï¼‰ â†’ æ–°ç½‘ç»œå¯èƒ½å¯ç”¨
3. æœåŠ¡å™¨ä¸´æ—¶æ•…éšœ â†’ ç­‰å¾…æ¢å¤
4. åŠ¨æ€URLåˆ—è¡¨ â†’ ä¸‹ä¸€è½®å¯èƒ½æœ‰æ–°çš„å¯ç”¨æœåŠ¡å™¨

æ— é™é‡è¯•ä¿è¯ï¼š
âœ… æœ€ç»ˆå¿…å®šæ‰¾åˆ°å¯ç”¨çš„æœåŠ¡å™¨ï¼ˆåªè¦å­˜åœ¨ï¼‰
âœ… ç”¨æˆ·æ— éœ€æ‰‹åŠ¨å¹²é¢„
âœ… åº”å¯¹å„ç§çªå‘ç½‘ç»œçŠ¶å†µ
```

**è®¾è®¡åŸåˆ™ï¼š** åœ¨é˜²ç«å¢™ç¯å¢ƒä¸‹ï¼Œæ”¾å¼ƒæ¯”é‡è¯•æ›´ä¸å¯æ¥å—ã€‚

### æ£€æµ‹æµç¨‹è¯¦è§£

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    getDomains(retry)                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ retry=false?  â”‚
         â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”˜
             â”‚       â”‚
        Yes  â”‚       â”‚ No
             â–¼       â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
      â”‚æœ‰ç¼“å­˜?   â”‚  â”‚
      â””â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”˜  â”‚
   Yes  â”‚    â”‚ No   â”‚
        â–¼    â””â”€â”€â”¬â”€â”€â”€â”˜
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
   â”‚è¿”å›ç¼“å­˜ â”‚ â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
               â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚      å¼€å§‹æ£€æµ‹å¾ªç¯ï¼ˆæ— é™ï¼‰            â”‚
        â”‚  while (true) {                      â”‚
        â”‚    æ£€æµ‹å½“å‰URLåˆ—è¡¨                   â”‚
        â”‚    if (æˆåŠŸ) return ç»“æœ;            â”‚
        â”‚    // å…¨éƒ¨å¤±è´¥                       â”‚
        â”‚    ç­‰å¾…2ç§’;                          â”‚
        â”‚    // é‡æ–°å¼€å§‹ï¼ˆå¯èƒ½æœ‰æ–°URLï¼‰       â”‚
        â”‚  }                                   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
             â”‚  é¡ºåºæ£€æµ‹URLåˆ—è¡¨     â”‚
             â”‚  for (entry in urls) â”‚
             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚ entry.method? â”‚
                â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚           â”‚           â”‚           â”‚
        â–¼           â–¼           â–¼           â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ api  â”‚   â”‚ file â”‚   â”‚navigate â”‚ â”‚ remove â”‚
    â””â”€â”€â”¬â”€â”€â”€â”˜   â””â”€â”€â”¬â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
       â”‚          â”‚             â”‚           â”‚
       â–¼          â–¼             â–¼           â–¼
   å‘é€åŠ å¯†    ä¸‹è½½åˆ—è¡¨      æ‰“å¼€æµè§ˆå™¨   åˆ é™¤URL
   è¯·æ±‚        é€’å½’æ£€æµ‹
       â”‚          â”‚             â”‚           â”‚
       â–¼          â–¼             â”‚           â”‚
   éªŒè¯ç­¾å    éªŒè¯ç­¾å         â”‚           â”‚
       â”‚          â”‚             â”‚           â”‚
       â–¼          â–¼             â–¼           â–¼
   æˆåŠŸ?      æˆåŠŸ?         è¿”å›æˆåŠŸ     ç»§ç»­ä¸‹ä¸€ä¸ª
       â”‚          â”‚          (ä¸é‡è¯•)    (å·²åˆ é™¤)
   Yes â”‚ No  Yes â”‚ No
       â–¼    â”‚     â–¼    â”‚
   è¿”å›æ•°æ® â”‚ è¿”å›æ•°æ® â”‚
   (ç»“æŸ)  â”‚  (ç»“æŸ)  â”‚
           â”‚          â”‚
           â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
           ç»§ç»­ä¸‹ä¸€ä¸ª
```

### Method æ·±åº¦è§£æ

#### 1. API Method - ä¸»åŠ›æ£€æµ‹

**æ€ç»´ï¼š** APIæ˜¯æœ€å¯é çš„æ–¹å¼ï¼Œæä¾›åŠ å¯†é€šä¿¡å’Œç­¾åéªŒè¯ã€‚

```
ä½¿ç”¨åœºæ™¯ï¼š
âœ… ç”Ÿäº§ç¯å¢ƒçš„ä¸»æœåŠ¡å™¨
âœ… éœ€è¦åŠ¨æ€è¿”å›é…ç½®çš„åœºæ™¯
âœ… éœ€è¦éªŒè¯å®¢æˆ·ç«¯èº«ä»½çš„åœºæ™¯

å·¥ä½œæµç¨‹ï¼š
1. å®¢æˆ·ç«¯ç”Ÿæˆ32å­—èŠ‚éšæœºnonceï¼ˆé˜²é‡æ”¾æ”»å‡»ï¼‰
2. æ„å»ºpayload: {nonce, os, app, data}
3. RSA-OAEP-SHA256 åŠ å¯†
4. POSTåˆ°æœåŠ¡å™¨
5. æœåŠ¡å™¨è§£å¯†ã€å¤„ç†ã€ç­¾å
6. å®¢æˆ·ç«¯éªŒè¯ç­¾åã€éªŒè¯nonceã€æå–æ•°æ®

æˆåŠŸ â†’ è¿”å›æ•°æ®ï¼ˆç»“æŸå¾ªç¯ï¼‰
å¤±è´¥ â†’ ç»§ç»­ä¸‹ä¸€ä¸ªURL
```

**è®¾è®¡æ„å›¾ï¼š** å®‰å…¨æ€§å’Œå¯é æ€§ä¼˜å…ˆï¼Œé€‚åˆæ ¸å¿ƒæœåŠ¡å™¨ã€‚

#### 2. File Method - åŠ¨æ€æ‰©å±•

**æ€ç»´ï¼š** é™æ€æ–‡ä»¶æ˜“äºåˆ†å‘ï¼Œå¯é€šè¿‡CDNå…¨çƒéƒ¨ç½²ã€‚

```
ä½¿ç”¨åœºæ™¯ï¼š
âœ… CDNåˆ†å‘çš„URLåˆ—è¡¨
âœ… GitHub/GitLabæ‰˜ç®¡çš„é…ç½®
âœ… é™æ€ç½‘ç«™æ‰˜ç®¡çš„åˆ—è¡¨
âœ… é€’å½’åŠ è½½å¤šçº§åˆ—è¡¨

å·¥ä½œæµç¨‹ï¼š
1. HTTP GET ä¸‹è½½æ–‡æœ¬æ–‡ä»¶
2. è§£æURLåˆ—è¡¨ï¼ˆæ”¯æŒ*PGFW*ã€JSONã€çº¯æ–‡æœ¬ï¼‰
3. é€’å½’æ£€æµ‹åˆ—è¡¨ä¸­çš„URLï¼ˆæ·±åº¦é™åˆ¶5ï¼‰
4. æ‰¾åˆ°å¯ç”¨æœåŠ¡å™¨åè¿”å›

æˆåŠŸ â†’ è¿”å›æ•°æ®ï¼ˆç»“æŸå¾ªç¯ï¼‰
å¤±è´¥ â†’ ç»§ç»­ä¸‹ä¸€ä¸ªURL

é€’å½’æ·±åº¦é™åˆ¶ï¼š
- é˜²æ­¢æ— é™é€’å½’
- é˜²æ­¢èµ„æºè€—å°½
- æœ€å¤§5å±‚åµŒå¥—
```

**è®¾è®¡æ„å›¾ï¼š** çµæ´»æ€§å’Œå¯æ‰©å±•æ€§ï¼Œé€‚åˆå¤‡ç”¨åˆ—è¡¨ã€‚

#### 3. Navigate Method - å¼•å¯¼ç”¨æˆ·

**æ€ç»´ï¼š** å½“æ‰€æœ‰è‡ªåŠ¨åŒ–æ–¹æ³•å¤±è´¥æ—¶ï¼Œäººå·¥ä»‹å…¥æ˜¯æœ€åçš„ä¿éšœã€‚

```
ä½¿ç”¨åœºæ™¯ï¼š
âœ… æ‰€æœ‰æœåŠ¡å™¨éƒ½æ— æ³•è®¿é—®
âœ… éœ€è¦ç”¨æˆ·æ‰‹åŠ¨æ›´æ–°åº”ç”¨
âœ… å¼•å¯¼ç”¨æˆ·æŸ¥çœ‹å¸®åŠ©æ–‡æ¡£
âœ… æç¤ºç”¨æˆ·ç½‘ç»œé—®é¢˜

å·¥ä½œæµç¨‹ï¼š
1. æ‰“å¼€é»˜è®¤æµè§ˆå™¨
2. è·³è½¬åˆ°æŒ‡å®šURLï¼ˆå¸®åŠ©é¡µé¢/ä¸‹è½½é¡µé¢ï¼‰
3. ç«‹å³è¿”å›æˆåŠŸå¯¹è±¡: {navigated: true, url: "..."}

â— å…³é”®ï¼šè¿”å›æˆåŠŸåä¸å†é‡è¯•

ä¸ºä»€ä¹ˆè¿”å›æˆåŠŸï¼Ÿ
âœ… å·²å®Œæˆå¼•å¯¼ä»»åŠ¡ï¼ˆç›®çš„è¾¾æˆï¼‰
âœ… é¿å…é‡å¤æ‰“å¼€æµè§ˆå™¨ï¼ˆç”¨æˆ·ä½“éªŒå·®ï¼‰
âœ… è®©è°ƒç”¨æ–¹çŸ¥é“"å·²å¼•å¯¼ç”¨æˆ·"è¿™ä¸ªçŠ¶æ€
```

**è®¾è®¡æ„å›¾ï¼š** äººå·¥ä»‹å…¥çš„æœ€åé˜²çº¿ï¼Œä¸åº”æ— é™é‡å¤ã€‚

#### 4. Remove Method - è‡ªæˆ‘æ›´æ–°

**æ€ç»´ï¼š** å…è®¸æœåŠ¡å™¨ä¸»åŠ¨æ¸…ç†å®¢æˆ·ç«¯çš„å¤±æ•ˆURLã€‚

```
ä½¿ç”¨åœºæ™¯ï¼š
âœ… æœåŠ¡å™¨è¿ç§»ï¼ˆåˆ é™¤æ—§åœ°å€ï¼‰
âœ… æ¸…ç†å¤±æ•ˆçš„å¤‡ç”¨æœåŠ¡å™¨
âœ… åŠ¨æ€è°ƒæ•´URLåˆ—è¡¨

å·¥ä½œæµç¨‹ï¼š
1. ä»æœ¬åœ°å­˜å‚¨åˆ é™¤æŒ‡å®šURL
2. è¿”å› nilï¼ˆç»§ç»­ä¸‹ä¸€ä¸ªï¼‰

â— å…³é”®ï¼šè¿”å›nilåç»§ç»­æ£€æµ‹

ä¸ºä»€ä¹ˆç»§ç»­è€Œä¸æ˜¯ç»“æŸï¼Ÿ
âœ… Removeæœ¬èº«ä¸æ˜¯æˆåŠŸçš„ç»ˆç‚¹
âœ… åˆ é™¤åéœ€è¦ç»§ç»­æ‰¾å¯ç”¨æœåŠ¡å™¨
âœ… é¿å…"åˆ é™¤æ—§URLåå°±åœæ­¢"çš„é—®é¢˜

æ‰§è¡Œæœºåˆ¶ï¼š
- ç¬¬1è½®ï¼šæ‰§è¡Œremoveåˆ é™¤URL
- ç¬¬1è½®ï¼šç»§ç»­æ£€æµ‹åç»­URL
- å¦‚æœå…¨éƒ¨å¤±è´¥ï¼Œè¿›å…¥ç¬¬2è½®
- ç¬¬2è½®ï¼šå·²åˆ é™¤çš„URLä¸å†å‡ºç°ï¼ˆå­˜å‚¨å·²æ›´æ–°ï¼‰
- åªæ‰§è¡Œä¸€æ¬¡ï¼ˆä¸ä¼šé‡å¤åˆ é™¤ï¼‰
```

**è®¾è®¡æ„å›¾ï¼š** åŠ¨æ€URLç®¡ç†ï¼Œæ”¯æŒæœåŠ¡å™¨ç«¯ä¸»åŠ¨ç»´æŠ¤ã€‚

### Store æœºåˆ¶çš„æ·±å±‚é€»è¾‘

**æ€ç»´ï¼š** å­¦ä¹ å‹ç³»ç»Ÿï¼ŒæˆåŠŸçš„URLåº”è¯¥ä¼˜å…ˆä½¿ç”¨ã€‚

```
å·¥ä½œåŸç†ï¼š
1. URLé…ç½®æ—¶æ ‡è®°: "store": true
2. æ£€æµ‹æˆåŠŸåè‡ªåŠ¨ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
3. ä¸‹æ¬¡å¯åŠ¨æ—¶ï¼Œå·²ä¿å­˜çš„URLä¼šæ’åœ¨åˆ—è¡¨å‰é¢
4. ä¼˜å…ˆæ£€æµ‹å·²éªŒè¯å¯ç”¨çš„æœåŠ¡å™¨

ä¼˜åŠ¿ï¼š
âœ… å‡å°‘æ£€æµ‹æ—¶é—´ï¼ˆä¼˜å…ˆæ£€æµ‹ä¸Šæ¬¡æˆåŠŸçš„ï¼‰
âœ… åŠ¨æ€é€‚åº”ç½‘ç»œç¯å¢ƒï¼ˆå„åœ°åŒºå¯ç”¨æœåŠ¡å™¨ä¸åŒï¼‰
âœ… è‡ªåŠ¨ç§¯ç´¯å¯ç”¨èµ„æº
âœ… æ”¯æŒæœåŠ¡å™¨ç«¯åŠ¨æ€ä¸‹å‘æ–°URL

åœºæ™¯ç¤ºä¾‹ï¼š
åˆå§‹é…ç½®:
[
  {"method": "api", "url": "https://server1.com/passgfw"},
  {"method": "file", "url": "https://cdn.com/list.txt"}
]

fileè¿”å›ï¼ˆå¸¦storeæ ‡è®°ï¼‰:
[
  {"method": "api", "url": "https://backup1.com/passgfw", "store": true},
  {"method": "api", "url": "https://backup2.com/passgfw", "store": true}
]

ç¬¬1æ¬¡æ£€æµ‹: server1å¤±è´¥ â†’ fileä¸‹è½½åˆ—è¡¨ â†’ backup1æˆåŠŸ âœ…
  â†’ backup1ä¿å­˜åˆ°æœ¬åœ°

ç¬¬2æ¬¡å¯åŠ¨: backup1ã€server1ã€fileï¼ˆä¼˜å…ˆæ£€æµ‹backup1ï¼‰
  â†’ backup1ç›´æ¥æˆåŠŸ âœ…ï¼ˆå¿«é€Ÿï¼‰
```

**è®¾è®¡æ„å›¾ï¼š** è‡ªé€‚åº”å’Œè‡ªä¼˜åŒ–ï¼Œå‡å°‘ç”¨æˆ·ç­‰å¾…æ—¶é—´ã€‚

### ç¼“å­˜æœºåˆ¶

**æ€ç»´ï¼š** é¿å…é‡å¤å·¥ä½œï¼Œæå‡å“åº”é€Ÿåº¦ã€‚

```
ç¼“å­˜ç­–ç•¥ï¼š
- ä½ç½®ï¼šå†…å­˜ï¼ˆè¿›ç¨‹çº§åˆ«ï¼Œä¸æŒä¹…åŒ–ï¼‰
- ç”Ÿå‘½å‘¨æœŸï¼šåº”ç”¨è¿è¡ŒæœŸé—´
- æ›´æ–°æ—¶æœºï¼šè°ƒç”¨getDomains(retry: true)

ä½¿ç”¨åœºæ™¯ï¼š
åœºæ™¯1ï¼šåº”ç”¨å¯åŠ¨
  getDomains(retry: false)
  â†’ æ— ç¼“å­˜ â†’ å¼€å§‹æ£€æµ‹ â†’ æˆåŠŸåç¼“å­˜

åœºæ™¯2ï¼šç”¨æˆ·åˆ‡æ¢é¡µé¢ï¼ˆåº”ç”¨ä»åœ¨è¿è¡Œï¼‰
  getDomains(retry: false)
  â†’ æœ‰ç¼“å­˜ â†’ ç›´æ¥è¿”å›ï¼ˆæå¿«ï¼‰

åœºæ™¯3ï¼šç”¨æˆ·æ‰‹åŠ¨åˆ·æ–°
  getDomains(retry: true)
  â†’ å¿½ç•¥ç¼“å­˜ â†’ é‡æ–°æ£€æµ‹ â†’ æ›´æ–°ç¼“å­˜

ä¸ºä»€ä¹ˆä¸æŒä¹…åŒ–ç¼“å­˜ï¼Ÿ
âœ… ç½‘ç»œç¯å¢ƒä¼šå˜åŒ–ï¼ˆWiFi/4G/5Gåˆ‡æ¢ï¼‰
âœ… æœåŠ¡å™¨çŠ¶æ€ä¼šå˜åŒ–ï¼ˆå¯èƒ½å¤±æ•ˆï¼‰
âœ… æ¯æ¬¡å¯åŠ¨é‡æ–°æ£€æµ‹æ›´å¯é 
```

**è®¾è®¡æ„å›¾ï¼š** ä¼šè¯å†…æ€§èƒ½ä¼˜åŒ–ï¼Œä¿æŒæ•°æ®æ–°é²œåº¦ã€‚

### å®Œæ•´æ‰§è¡Œç¤ºä¾‹

**ç¤ºä¾‹1ï¼šæ­£å¸¸æ£€æµ‹æˆåŠŸ**
```
é…ç½®: [api1, api2, api3]

æ‰§è¡Œ:
  ç¬¬1è½®:
    æ£€æµ‹ api1 â†’ å¤±è´¥ï¼ˆè¶…æ—¶ï¼‰
    æ£€æµ‹ api2 â†’ æˆåŠŸ âœ…
    è¿”å›æ•°æ®ï¼Œç»“æŸ

æ€»è€—æ—¶: ~5ç§’
```

**ç¤ºä¾‹2ï¼šæ‰€æœ‰æœåŠ¡å™¨å¤±è´¥ï¼Œé‡è¯•åæˆåŠŸ**
```
é…ç½®: [api1, api2]

æ‰§è¡Œ:
  ç¬¬1è½®:
    æ£€æµ‹ api1 â†’ å¤±è´¥
    æ£€æµ‹ api2 â†’ å¤±è´¥
    ç­‰å¾…2ç§’
  ç¬¬2è½®:
    æ£€æµ‹ api1 â†’ å¤±è´¥
    æ£€æµ‹ api2 â†’ æˆåŠŸ âœ…ï¼ˆç½‘ç»œæ¢å¤äº†ï¼‰
    è¿”å›æ•°æ®ï¼Œç»“æŸ

æ€»è€—æ—¶: ~12ç§’
```

**ç¤ºä¾‹3ï¼šNavigateå¼•å¯¼**
```
é…ç½®: [api1, api2, navigate(help.com)]

æ‰§è¡Œ:
  ç¬¬1è½®:
    æ£€æµ‹ api1 â†’ å¤±è´¥
    æ£€æµ‹ api2 â†’ å¤±è´¥
    æ‰§è¡Œ navigate â†’ æ‰“å¼€æµè§ˆå™¨ â†’ è¿”å›{navigated: true} âœ…
    ç»“æŸï¼ˆä¸å†é‡è¯•ï¼‰

ç»“æœ: ç”¨æˆ·è¢«å¼•å¯¼åˆ°å¸®åŠ©é¡µé¢
```

**ç¤ºä¾‹4ï¼šRemove + Store ç»„åˆ**
```
é…ç½®: [remove(old.com), api1(store), api2(store)]

æ‰§è¡Œ:
  ç¬¬1è½®:
    æ‰§è¡Œ remove(old.com) â†’ åˆ é™¤æˆåŠŸ â†’ ç»§ç»­
    æ£€æµ‹ api1 â†’ æˆåŠŸ âœ…
    ä¿å­˜ api1 åˆ°æœ¬åœ°
    è¿”å›æ•°æ®ï¼Œç»“æŸ

ä¸‹æ¬¡å¯åŠ¨:
é…ç½®: [api1(å·²ä¿å­˜), remove(old.com), api1(store), api2(store)]
  ç¬¬1è½®:
    æ£€æµ‹ api1(å·²ä¿å­˜) â†’ æˆåŠŸ âœ…ï¼ˆå¿«é€Ÿï¼‰
    è¿”å›æ•°æ®ï¼Œç»“æŸ

ä¼˜åŒ–æ•ˆæœ: ä»10ç§’æ£€æµ‹é™è‡³2ç§’
```

**ç¤ºä¾‹5ï¼šFileé€’å½’åŠ è½½**
```
é…ç½®: [file(cdn.com/list.txt)]

fileå†…å®¹: [api1, file(github.com/backup.txt)]
backup.txtå†…å®¹: [api2(store), api3(store)]

æ‰§è¡Œ:
  ç¬¬1è½®:
    æ£€æµ‹ file(cdn.com/list.txt) â†’ ä¸‹è½½æˆåŠŸ
      é€’å½’æ£€æµ‹ api1 â†’ å¤±è´¥
      é€’å½’æ£€æµ‹ file(github.com/backup.txt) â†’ ä¸‹è½½æˆåŠŸ
        é€’å½’æ£€æµ‹ api2 â†’ æˆåŠŸ âœ…
        ä¿å­˜ api2 åˆ°æœ¬åœ°
    è¿”å›æ•°æ®ï¼Œç»“æŸ

ä¸‹æ¬¡å¯åŠ¨:
é…ç½®: [api2(å·²ä¿å­˜), file(cdn.com/list.txt)]
  ç¬¬1è½®:
    æ£€æµ‹ api2(å·²ä¿å­˜) â†’ æˆåŠŸ âœ…ï¼ˆç›´æ¥å‘½ä¸­ï¼‰
```

### è®¾è®¡å“²å­¦æ€»ç»“

```
æ ¸å¿ƒä»·å€¼è§‚ï¼š
1. ç®€å•å¯é  > å¤æ‚é«˜æ•ˆ
   â†’ ä¸²è¡Œæ£€æµ‹ï¼Œæ˜“äºç†è§£å’Œç»´æŠ¤

2. æœ€ç»ˆä¸€è‡´æ€§
   â†’ æ— é™é‡è¯•ï¼Œä¿è¯æœ€ç»ˆæˆåŠŸ

3. è‡ªé€‚åº”èƒ½åŠ›
   â†’ Storeæœºåˆ¶ï¼Œå­¦ä¹ å¯ç”¨æœåŠ¡å™¨

4. ç”¨æˆ·ä½“éªŒ
   â†’ Navigateå¼•å¯¼ï¼Œäººæœºåä½œ

5. å®‰å…¨ç¬¬ä¸€
   â†’ RSAåŠ å¯†ï¼Œç­¾åéªŒè¯

6. å¹³å°åŸç”Ÿ
   â†’ é¿å…è·¨å¹³å°æ¡†æ¶çš„å¤æ‚æ€§
```

---

## ğŸ”’ å®‰å…¨æœºåˆ¶

### 1. RSA 2048ä½åŠ å¯†é€šä¿¡

**å®¢æˆ·ç«¯ â†’ æœåŠ¡å™¨ï¼š**
```
1. ç”Ÿæˆ32å­—èŠ‚éšæœºnonce
2. æ„å»ºpayload: {nonce, os, app, data}
3. RSA-OAEP-SHA256åŠ å¯†payload
4. POST åŸå§‹bytesåˆ°æœåŠ¡å™¨
```

**æœåŠ¡å™¨ â†’ å®¢æˆ·ç«¯ï¼š**
```
1. RSA-OAEP-SHA256è§£å¯†payload
2. æ„å»ºå“åº”æ•°æ®: {domain, version, ...}
3. ç¼–ç ä¸ºJSON bytes: dataBytes = json.Marshal(responseData)
4. æ„å»ºå“åº”å¯¹è±¡: {nonce: []byte, data: []byte, urls: []URLEntry}
5. Marshalæ•´ä¸ªå“åº”å¯¹è±¡: signBytes = json.Marshal(response)
6. ç­¾å: sign(signBytes) ä½¿ç”¨ RSA-PSS-SHA256
7. è¿”å›: {nonce: []byte, data: []byte, urls: []URLEntry, signature: []byte}
   ï¼ˆJSONä¸­è‡ªåŠ¨base64ç¼–ç ï¼‰
```

### 2. ç­¾åéªŒè¯

**è®¾è®¡ï¼šé‡æ–°æ„å»ºå“åº”å¯¹è±¡å¹¶marshaléªŒè¯**

```typescript
// å®¢æˆ·ç«¯éªŒè¯æµç¨‹
// 1. æ”¶åˆ°å“åº”
const response = {
  nonce: "base64...",      // []byte -> base64
  data: "base64...",       // []byte -> base64
  urls: [...],             // optional
  signature: "base64..."   // []byte -> base64
};

// 2. é‡æ–°æ„å»ºå“åº”å¯¹è±¡ï¼ˆä¸å«signatureï¼‰
const responseForVerify = {
  nonce: response.nonce,
  data: response.data,
  urls: response.urls  // å¦‚æœæœ‰
};

// 3. Marshalï¼ˆå¿…é¡»å’ŒæœåŠ¡å™¨å­—æ®µé¡ºåºä¸€è‡´ï¼‰
const verifyBytes = jsonMarshal(responseForVerify);  // {"nonce":"...","data":"...","urls":[...]}

// 4. éªŒè¯ç­¾å
const signatureBytes = base64Decode(response.signature);
verify(verifyBytes, signatureBytes);  // âœ… æˆåŠŸ
```

**æœåŠ¡å™¨ç«¯å®ç°ï¼š**
```go
// è§£ç nonce
nonceBytes, _ := base64.StdEncoding.DecodeString(payload.Nonce)

// åºåˆ—åŒ–å“åº”æ•°æ®
responseData := map[string]any{"domain": "example.com", "version": "2.2"}
dataBytes, _ := json.Marshal(responseData)

// æ„å»ºå“åº”å¯¹è±¡ï¼ˆç”¨äºç­¾åï¼‰
responseForSigning := PassGFWResponse{
    Nonce: nonceBytes,
    Data:  dataBytes,
    URLs:  nil,  // å¦‚æœéœ€è¦
}

// Marshalæ•´ä¸ªå“åº”å¯¹è±¡
signBytes, _ := json.Marshal(responseForSigning)

// ç­¾å
hashed := sha256.Sum256(signBytes)
signature, _ := rsa.SignPSS(rand.Reader, privateKey, crypto.SHA256, hashed[:], nil)

// è¿”å›å“åº”ï¼ˆ[]byteè‡ªåŠ¨base64ç¼–ç ï¼‰
response := PassGFWResponse{
    Nonce:     nonceBytes,     // JSON: "nonce": "base64..."
    Data:      dataBytes,      // JSON: "data": "base64..."
    URLs:      nil,            // JSON: "urls": [...] æˆ–çœç•¥
    Signature: signature,      // JSON: "signature": "base64..."
}
```

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. é…ç½®æ„å»ºå‚æ•°

```bash
cd clients
cp build_config.example.json build_config.json
vim build_config.json
```

```json
{
  "urls": [
    {"method": "api", "url": "https://server1.com/passgfw"},
    {"method": "api", "url": "https://server2.com/passgfw", "store": true},
    {"method": "file", "url": "https://cdn.com/list.txt"}
  ],
  "public_key_path": "../server/keys/public_key.pem"
}
```

### 2. å¯åŠ¨æœåŠ¡å™¨

```bash
cd server
go run main.go -domain=yourdomain.com -port=8080
```

### 3. æ„å»ºå®¢æˆ·ç«¯

```bash
cd clients

# iOS/macOS
swift build

# Android
./gradlew :passgfw:assembleRelease

# HarmonyOS
hvigorw assembleHap
```

---

## ğŸ’» ä½¿ç”¨ç¤ºä¾‹

### iOS/macOS

```swift
import PassGFW

let client = PassGFWClient()

// é¦–æ¬¡æ£€æµ‹ï¼ˆæ— ç¼“å­˜ï¼‰
if let domains = await client.getDomains(retry: false) {
    print("Domain: \(domains["domain"] ?? "unknown")")
}

// å¼ºåˆ¶åˆ·æ–°
if let domains = await client.getDomains(retry: true) {
    print("Refreshed: \(domains)")
}
```

### Android

```kotlin
import com.passgfw.PassGFW

val passgfw = PassGFW(context)

// é¦–æ¬¡æ£€æµ‹
lifecycleScope.launch {
    val domains = passgfw.getDomains(retry = false)
    domains?.let {
        val domain = it["domain"] as? String
        println("Domain: $domain")
    }
}
```

### HarmonyOS

```typescript
import { PassGFW } from './passgfw/PassGFW';

const passgfw = new PassGFW();
await passgfw.initialize(this.context);

// é¦–æ¬¡æ£€æµ‹
const domains = await passgfw.getDomains(false);
if (domains) {
  console.log('Domain:', domains.domain);
}
```

---

## ğŸ“‹ URLåˆ—è¡¨æ ¼å¼

PassGFWæ”¯æŒå¤šç§æ ¼å¼çš„URLåˆ—è¡¨ï¼Œæ¨èä½¿ç”¨ **\*PGFW\*** æ ¼å¼ä»¥ä¾¿éšè”½åµŒå…¥ã€‚

### *PGFW* æ ¼å¼ï¼ˆæ¨èï¼‰

å¯åµŒå…¥åˆ°ä»»ä½•æ–‡æœ¬ä¸­ï¼ˆHTMLæ³¨é‡Šã€CSSã€æ™®é€šæ–‡æœ¬ï¼‰ï¼š

```html
<!--
*PGFW*W3sibWV0aG9kIjoiYXBpIiwidXJsIjoiaHR0cHM6Ly9zZXJ2ZXIxLmNvbS9wYXNzZ2Z3In1d*PGFW*
-->
```

**ç”Ÿæˆæ–¹æ³•ï¼š**
```python
import json, base64

urls = [
    {"method": "api", "url": "https://server1.com/passgfw"},
    {"method": "api", "url": "https://server2.com/passgfw", "store": True}
]

json_str = json.dumps(urls)
b64_str = base64.b64encode(json_str.encode()).decode()
result = f"*PGFW*{b64_str}*PGFW*"
print(result)
```

### å…¶ä»–æ ¼å¼

**ç›´æ¥JSONæ•°ç»„ï¼š**
```json
[
  {"method": "api", "url": "https://server1.com/passgfw"},
  {"method": "api", "url": "https://server2.com/passgfw", "store": true}
]
```

**Legacyæ ¼å¼ï¼ˆå…¼å®¹ï¼‰ï¼š**
```json
{
  "urls": [
    {"method": "api", "url": "https://server1.com/passgfw"}
  ]
}
```

**çº¯æ–‡æœ¬ï¼ˆé™çº§ï¼‰ï¼š**
```
https://server1.com/passgfw
https://server2.com/passgfw
```

è¯¦è§ï¼š[docs/list_format_examples.md](docs/list_format_examples.md)

---

## ğŸ”§ åŠ¨æ€URLç®¡ç†

### Store - æŒä¹…åŒ–URL

ä½¿ç”¨ `store: true` æ ‡è®°çš„URLåœ¨æ£€æµ‹æˆåŠŸåä¼šä¿å­˜åˆ°æœ¬åœ°ï¼š

```json
[
  {"method": "api", "url": "https://backup1.com/passgfw", "store": true},
  {"method": "api", "url": "https://backup2.com/passgfw", "store": true}
]
```

**æ•ˆæœï¼š**
- é¦–æ¬¡æ£€æµ‹æˆåŠŸåè‡ªåŠ¨ä¿å­˜
- ä¸‹æ¬¡å¯åŠ¨è‡ªåŠ¨åŠ è½½ï¼ˆæ— éœ€é‡æ–°ä¸‹è½½ï¼‰
- ç”¨äºåŠ¨æ€æ·»åŠ æ–°æœåŠ¡å™¨

### Remove - åˆ é™¤URL

ä½¿ç”¨ `remove` æ–¹æ³•ä»æœ¬åœ°åˆ é™¤å¤±æ•ˆçš„URLï¼š

```json
[
  {"method": "remove", "url": "https://old-server.com/passgfw"},
  {"method": "api", "url": "https://new-server.com/passgfw", "store": true}
]
```

**æœåŠ¡å™¨è¿ç§»ç¤ºä¾‹ï¼š**
```json
[
  {"method": "remove", "url": "https://old.com/passgfw"},
  {"method": "api", "url": "https://new.com/passgfw", "store": true},
  {"method": "api", "url": "https://backup1.com/passgfw", "store": true},
  {"method": "api", "url": "https://backup2.com/passgfw", "store": true}
]
```

### é¡ºåºå¤„ç†ç¤ºä¾‹

**ç¤ºä¾‹1ï¼šNavigateå¼•å¯¼ç”¨æˆ·**
```json
[
  {"method": "api", "url": "https://server1.com/passgfw"},
  {"method": "api", "url": "https://server2.com/passgfw"},
  {"method": "navigate", "url": "https://help.example.com/guide"}
]
```

æ‰§è¡Œæµç¨‹ï¼š
- ç¬¬1è½®ï¼šserver1 å¤±è´¥ â†’ server2 å¤±è´¥ â†’ **navigate æ‰“å¼€æµè§ˆå™¨ â†’ è¿”å›æˆåŠŸ**
- ç»“æœï¼šå¼•å¯¼ç”¨æˆ·è®¿é—®å¸®åŠ©é¡µé¢ï¼ˆnavigateåä¸å†é‡è¯•ï¼‰

**ç¤ºä¾‹2ï¼šRemove + é‡è¯•**
```json
[
  {"method": "remove", "url": "https://old.com/passgfw"},
  {"method": "api", "url": "https://server1.com/passgfw"},
  {"method": "api", "url": "https://server2.com/passgfw"}
]
```

æ‰§è¡Œæµç¨‹ï¼š
- ç¬¬1è½®ï¼šremove åˆ é™¤ old.com â†’ server1 å¤±è´¥ â†’ server2 å¤±è´¥ â†’ **ç­‰å¾…2ç§’**
- ç¬¬2è½®ï¼šserver1 å¤±è´¥ â†’ server2 æˆåŠŸ â†’ è¿”å›æ•°æ®
- ç»“æœï¼šæˆåŠŸæ¸…ç†æ—§URLå¹¶æ‰¾åˆ°å¯ç”¨æœåŠ¡å™¨

**ç¤ºä¾‹3ï¼šæ··åˆä½¿ç”¨**
```json
[
  {"method": "remove", "url": "https://deprecated.com/passgfw"},
  {"method": "api", "url": "https://primary.com/passgfw"},
  {"method": "file", "url": "https://cdn.com/backup-list.txt"},
  {"method": "navigate", "url": "https://help.com/troubleshoot"}
]
```

æ‰§è¡Œæµç¨‹ï¼ˆæ‰€æœ‰æœåŠ¡å™¨éƒ½å¤±è´¥æ—¶ï¼‰ï¼š
- ç¬¬1è½®ï¼šremove åˆ é™¤ â†’ primary å¤±è´¥ â†’ file å¤±è´¥ â†’ **navigate æ‰“å¼€æµè§ˆå™¨ â†’ è¿”å›æˆåŠŸ**
- ç»“æœï¼šå¼•å¯¼ç”¨æˆ·æŸ¥çœ‹æ•…éšœæ’é™¤æŒ‡å—

---

## ğŸ“Š ä»£ç ç»Ÿè®¡

| å¹³å° | è¯­è¨€ | æ ¸å¿ƒä»£ç è¡Œæ•° | ç®€åŒ–å‰ |
|------|------|------------|--------|
| iOS/macOS | Swift | ~400è¡Œ | ~1200è¡Œ |
| Android | Kotlin | ~500è¡Œ | ~1200è¡Œ |
| HarmonyOS | ArkTS | ~500è¡Œ | ~1000è¡Œ |
| Server | Go | ~300è¡Œ | ~800è¡Œ |

**ç®€åŒ–é‡ç‚¹ï¼š**
- âœ… ç§»é™¤å¹¶å‘æ£€æµ‹æœºåˆ¶
- âœ… ç§»é™¤è‡ªåŠ¨æ£€æµ‹å®šæ—¶å™¨
- âœ… ç§»é™¤å¤æ‚çš„URLä¼˜å…ˆçº§æ’åº
- âœ… ç§»é™¤countå±æ€§å’Œä¼šè¯çŠ¶æ€è·Ÿè¸ª
- âœ… ç®€åŒ–ä¸ºï¼šä¸²è¡Œæ£€æµ‹ + æ— é™é‡è¯• + å†…å­˜ç¼“å­˜

---

## ğŸ› ï¸ å¼€å‘æŒ‡å—

### æœåŠ¡å™¨ç®¡ç†é¡µé¢

è®¿é—® `http://your-server:8080/admin` æŸ¥çœ‹ï¼š
- ğŸ“Š å®æ—¶ç»Ÿè®¡ï¼ˆè¯·æ±‚æ•°ã€å¹³å°åˆ†å¸ƒï¼‰
- ğŸ”— URLåˆ—è¡¨ç”Ÿæˆå™¨
- ğŸ“ *PGFW* æ ¼å¼è½¬æ¢å·¥å…·

### æ„å»ºè„šæœ¬

```bash
cd clients

# æ¸…ç†æ‰€æœ‰å¹³å°
./build.sh clean

# éªŒè¯æ‰€æœ‰å¹³å°ï¼ˆå¹¶è¡Œï¼‰
./build.sh verify
```

### æµ‹è¯•

```bash
# iOS/macOS
cd clients/ios-macos
swift test

# Android
cd clients/android
./gradlew test

# Server
cd server
go test ./...
```

---

## ğŸ” å®‰å…¨æ³¨æ„äº‹é¡¹

1. **ç§é’¥ä¿æŠ¤**ï¼šæœåŠ¡å™¨ç§é’¥ä¸å¾—æ³„éœ²ï¼Œä½¿ç”¨ `-private-key` å‚æ•°æŒ‡å®š
2. **HTTPSä¼ è¾“**ï¼šç”Ÿäº§ç¯å¢ƒå¿…é¡»ä½¿ç”¨HTTPSä¿æŠ¤ä¼ è¾“å±‚
3. **APIç­¾å**ï¼šå®¢æˆ·ç«¯å¿…é¡»éªŒè¯æœåŠ¡å™¨ç­¾åï¼Œé˜²æ­¢ä¸­é—´äººæ”»å‡»
4. **Fileæ–¹æ³•**ï¼šä»ä¸å¯ä¿¡æ¥æºè·å–çš„åˆ—è¡¨å­˜åœ¨é£é™©
5. **é€’å½’é™åˆ¶**ï¼šé˜²æ­¢æ— é™é€’å½’å’Œèµ„æºè€—å°½

---

## ğŸ“ æ›´æ–°æ—¥å¿—

### v2.2 (å½“å‰ç‰ˆæœ¬)

**é‡å¤§ç®€åŒ–ï¼š**
- âœ… å•ä¸€APIï¼š`getDomains(retry)` æ›¿ä»£å¤šä¸ªå¤æ‚æ¥å£
- âœ… å»é™¤countå±æ€§å’Œä¼šè¯çŠ¶æ€è·Ÿè¸ª
- âœ… ç®€åŒ–ä¸ºä¸²è¡Œæ£€æµ‹ + æ— é™é‡è¯•
- âœ… ä»£ç é‡å‡å°‘60%ï¼ˆ~400è¡Œ/å¹³å°ï¼‰

**ç­¾åéªŒè¯ä¼˜åŒ–ï¼š**
- âœ… æ”¹ä¸º marshal(response) ç­¾åéªŒè¯
- âœ… æœåŠ¡å™¨è¿”å› []byte ç±»å‹ï¼ˆJSONè‡ªåŠ¨base64ç¼–ç ï¼‰
- âœ… å®¢æˆ·ç«¯é‡æ–°æ„å»ºå“åº”å¯¹è±¡éªŒè¯

**é¡ºåºå¤„ç†ä¿®å¤ï¼š**
- âœ… navigate æ‰§è¡Œåè¿”å›æˆåŠŸï¼Œä¸å†é‡å¤æ‰“å¼€æµè§ˆå™¨
- âœ… remove æ‰§è¡Œåç»§ç»­ä¸‹ä¸€ä¸ªï¼Œåªæ‰§è¡Œä¸€æ¬¡

**Bugä¿®å¤ï¼š**
- ğŸ› ä¿®å¤æ–‡æ¡£ä¸­storeä½œä¸ºmethodçš„é”™è¯¯æè¿°

### v2.1

- å¹¶å‘æ£€æµ‹æ”¯æŒ
- å®Œæ•´ç»Ÿè®¡ä¿¡æ¯
- ä¸‰å¹³å°ä»£ç ç»Ÿä¸€

### v2.0

- Navigateæ–¹æ³•
- åŠ å¯†å­˜å‚¨
- Androidæµ‹è¯•åº”ç”¨

---

## ğŸ“„ è®¸å¯è¯

MIT License

---

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

**å¼€å‘åŸåˆ™ï¼š**
- ä¿æŒç®€å•ï¼šé¿å…è¿‡åº¦è®¾è®¡
- å¹³å°åŸç”Ÿï¼šä¸ä½¿ç”¨è·¨å¹³å°æ¡†æ¶
- å®‰å…¨ç¬¬ä¸€ï¼šåŠ å¯†å’Œç­¾åéªŒè¯
- ä»£ç ç²¾ç®€ï¼šæ ¸å¿ƒåŠŸèƒ½ < 500è¡Œ

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [URLåˆ—è¡¨æ ¼å¼è¯¦è§£](docs/list_format_examples.md)
- [å®‰å…¨ä¸æƒé™è¯´æ˜](docs/SECURITY_AND_PERMISSIONS.md)
- [å®¢æˆ·ç«¯æ„å»ºè¯´æ˜](clients/BUILD_README.md)
