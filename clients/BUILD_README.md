# PassGFW æ„å»ºæŒ‡å—

æœ¬é¡¹ç›®æä¾›ä¸¤ç§æ„å»ºæ–¹å¼ï¼š**é…ç½®æ–‡ä»¶æ„å»º**å’Œ**äº¤äº’å¼æ„å»º**ã€‚

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ–¹å¼1ï¼šäº¤äº’å¼æ„å»ºï¼ˆæ¨èæ–°æ‰‹ï¼‰

```bash
./build_interactive.sh <platform>
```

è„šæœ¬ä¼šå¼•å¯¼æ‚¨é…ç½®æ‰€æœ‰å‚æ•°ï¼Œæ”¯æŒï¼š
- ğŸ“ äº¤äº’å¼è¾“å…¥é…ç½®
- ğŸ’¾ ä¿å­˜é…ç½®ä¾›å°†æ¥ä½¿ç”¨
- âœ… é»˜è®¤å€¼æç¤ºï¼ˆé»„è‰²æ˜¾ç¤ºï¼‰
- ğŸ¨ å½©è‰²ç•Œé¢ï¼Œæ˜“äºé˜…è¯»

**ç¤ºä¾‹**ï¼š
```bash
# æ„å»º iOS
./build_interactive.sh ios

# æ„å»º Android
./build_interactive.sh android

# æ„å»ºæ‰€æœ‰å¹³å°
./build_interactive.sh all
```

### æ–¹å¼2ï¼šé…ç½®æ–‡ä»¶æ„å»ºï¼ˆæ¨èé«˜çº§ç”¨æˆ·ï¼‰

```bash
./build.sh <platform> --config <config_file>
```

**ç¤ºä¾‹**ï¼š
```bash
# ä½¿ç”¨é»˜è®¤é…ç½®
./build.sh ios

# ä½¿ç”¨è‡ªå®šä¹‰é…ç½®
./build.sh android --config production_config.json

# æ¸…ç†æ„å»º
./build.sh all --clean

# å¹¶è¡Œæ„å»ºæ‰€æœ‰å¹³å°
./build.sh all --parallel
```

---

## ğŸ“‹ é…ç½®å‚æ•°è¯´æ˜

### 1. åŸºç¡€é…ç½®

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `urls` | Array | localhost:8080 | æ£€æµ‹ URL åˆ—è¡¨ |
| `public_key_path` | String | ../server/keys/public_key.pem | RSA å…¬é’¥è·¯å¾„ |

### 2. ç½‘ç»œå‚æ•°

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `request_timeout` | Number | 5 | HTTP è¯·æ±‚è¶…æ—¶ï¼ˆç§’ï¼‰ |
| `max_retries` | Number | 2 | æœ€å¤§é‡è¯•æ¬¡æ•° |
| `retry_delay` | Number | 0.5 | é‡è¯•å»¶è¿Ÿï¼ˆç§’ï¼‰ |
| `retry_interval` | Number | 2 | å…¨éƒ¨å¤±è´¥åé‡è¯•é—´éš”ï¼ˆç§’ï¼‰ |
| `url_interval` | Number | 0.5 | URL æ£€æµ‹é—´éš”ï¼ˆç§’ï¼‰ |

### 3. å®‰å…¨å‚æ•°

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `max_list_recursion_depth` | Number | 5 | æœ€å¤§é€’å½’æ·±åº¦ |
| `nonce_size` | Number | 32 | Nonce å¤§å°ï¼ˆå­—èŠ‚ï¼‰ |
| `max_client_data_size` | Number | 200 | æœ€å¤§ client_data å¤§å°ï¼ˆå­—èŠ‚ï¼‰ |

### 4. å¹¶å‘é…ç½® âš¡ **æ–°åŠŸèƒ½**

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `enable_concurrent_check` | Boolean | true | å¯ç”¨å¹¶å‘æ£€æµ‹ |
| `concurrent_check_count` | Number | 3 | å¹¶å‘æ‰¹æ¬¡å¤§å°ï¼ˆåŒæ—¶æ£€æµ‹çš„ URL æ•°ï¼‰ |
| `file_method_concurrent` | Boolean | false | File ç±»å‹æ˜¯å¦å…è®¸å¹¶å‘ï¼ˆä¸æ¨èï¼‰ |

---

## ğŸ“ é…ç½®æ–‡ä»¶ç¤ºä¾‹

### æœ€å°é…ç½®
```json
{
  "urls": [
    {
      "method": "api",
      "url": "https://example.com/passgfw"
    }
  ],
  "public_key_path": "../server/keys/public_key.pem"
}
```

### å®Œæ•´é…ç½®
```json
{
  "urls": [
    {
      "method": "api",
      "url": "https://api1.example.com/passgfw"
    },
    {
      "method": "api",
      "url": "https://api2.example.com/passgfw"
    },
    {
      "method": "file",
      "url": "https://example.com/urls.json"
    }
  ],
  "public_key_path": "../server/keys/production_key.pem",
  "config": {
    "request_timeout": 10,
    "max_retries": 3,
    "retry_delay": 1,
    "retry_interval": 5,
    "url_interval": 0.5,
    "max_list_recursion_depth": 5,
    "nonce_size": 32,
    "max_client_data_size": 200,
    "enable_concurrent_check": true,
    "concurrent_check_count": 5,
    "file_method_concurrent": false
  }
}
```

---

## ğŸ¯ äº¤äº’å¼æ„å»ºæµç¨‹ç¤ºä¾‹

```bash
$ ./build_interactive.sh ios

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘   ğŸš€ PassGFW äº¤äº’å¼æ„å»ºå·¥å…·                                      â•‘
â•‘   Version 2.1.0                                                  â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

æœ¬å·¥å…·å°†å¼•å¯¼æ‚¨é…ç½®æ„å»ºå‚æ•°ã€‚
æ‚¨å¯ä»¥ç›´æ¥æŒ‰ Enter ä½¿ç”¨é»˜è®¤å€¼ï¼ˆé»„è‰²æ˜¾ç¤ºï¼‰ã€‚

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“ åŸºç¡€é…ç½®
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
â¯ æ˜¯å¦ä½¿ç”¨æ‰€æœ‰é»˜è®¤é…ç½®ï¼Ÿ(å¿«é€Ÿæ„å»º) [Y/n]: n

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸŒ URL é…ç½®
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
è¯·è¾“å…¥æ£€æµ‹ URLï¼ˆæ”¯æŒå¤šä¸ªï¼‰
æ ¼å¼: method,url
ä¾‹å¦‚: api,http://example.com/passgfw

æ”¯æŒçš„ method: api, file, navigate, remove
è¾“å…¥ç©ºè¡Œå®Œæˆè¾“å…¥

â¯ URL #1 [é»˜è®¤: ]: api,https://api1.example.com/passgfw
âœ… å·²æ·»åŠ : api,https://api1.example.com/passgfw
â¯ URL #2 [é»˜è®¤: ]: api,https://api2.example.com/passgfw
âœ… å·²æ·»åŠ : api,https://api2.example.com/passgfw
â¯ URL #3 [é»˜è®¤: ]:

âœ… å·²é…ç½® 2 ä¸ª URL

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ”‘ å…¬é’¥é…ç½®
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
â¯ å…¬é’¥æ–‡ä»¶è·¯å¾„ [é»˜è®¤: ../server/keys/public_key.pem]:

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âš™ï¸  ç½‘ç»œå‚æ•°
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
â¯ HTTP è¯·æ±‚è¶…æ—¶ (ç§’) [é»˜è®¤: 5]:
â¯ æœ€å¤§é‡è¯•æ¬¡æ•° [é»˜è®¤: 2]:
â¯ é‡è¯•å»¶è¿Ÿ (ç§’) [é»˜è®¤: 0.5]:
â¯ å…¨éƒ¨å¤±è´¥åé‡è¯•é—´éš” (ç§’) [é»˜è®¤: 2]:
â¯ URL æ£€æµ‹é—´éš” (ç§’) [é»˜è®¤: 0.5]:

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ”’ å®‰å…¨å‚æ•°
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
â¯ æœ€å¤§é€’å½’æ·±åº¦ [é»˜è®¤: 5]:
â¯ Nonce å¤§å° (å­—èŠ‚) [é»˜è®¤: 32]:
â¯ æœ€å¤§ client_data å¤§å° (å­—èŠ‚) [é»˜è®¤: 200]:

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âš¡ å¹¶å‘é…ç½®
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
å¹¶å‘æ£€æµ‹å¯ä»¥æ˜¾è‘—æå‡æ£€æµ‹é€Ÿåº¦ï¼ˆæ¨èå¯ç”¨ï¼‰

â¯ å¯ç”¨å¹¶å‘æ£€æµ‹ï¼Ÿ [Y/n]: y
â¯ å¹¶å‘æ‰¹æ¬¡å¤§å° (å»ºè®®2-5) [é»˜è®¤: 3]: 5
â¯ File ç±»å‹å…è®¸å¹¶å‘ï¼Ÿ(ä¸æ¨èï¼Œå¯èƒ½å¯¼è‡´é€’å½’çˆ†ç‚¸) [y/N]: n

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“‹ é…ç½®æ‘˜è¦
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
å¹³å°:       ios
URL æ•°é‡:   2
å…¬é’¥:       ../server/keys/public_key.pem
è¶…æ—¶:       5s
é‡è¯•:       2æ¬¡
å¹¶å‘æ£€æµ‹:   å¯ç”¨ (æ‰¹æ¬¡å¤§å°: 5)

â¯ ç¡®è®¤å¼€å§‹æ„å»ºï¼Ÿ [Y/n]: y

â¯ æ˜¯å¦ä¿å­˜æ­¤é…ç½®ä»¥ä¾›å°†æ¥ä½¿ç”¨ï¼Ÿ [y/N]: y
â¯ é…ç½®æ–‡ä»¶å [é»˜è®¤: my_config.json]: production_config.json
âœ… é…ç½®å·²ä¿å­˜åˆ°: production_config.json
ä¸‹æ¬¡å¯ä½¿ç”¨: ./build.sh ios --config production_config.json

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ”¨ å¼€å§‹æ„å»º
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âœ… ä¸´æ—¶é…ç½®æ–‡ä»¶å·²åˆ›å»º

âœ… è°ƒç”¨æ„å»ºè„šæœ¬...

[æ„å»ºè¿‡ç¨‹...]

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘   ğŸ‰ æ„å»ºæˆåŠŸå®Œæˆï¼                                               â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## ğŸ”§ å‘½ä»¤è¡Œé€‰é¡¹ (build.sh)

```bash
./build.sh <platform> [options]
```

### é€‰é¡¹

| é€‰é¡¹ | è¯´æ˜ |
|------|------|
| `--config FILE` | ä½¿ç”¨è‡ªå®šä¹‰é…ç½®æ–‡ä»¶ï¼ˆé»˜è®¤: build_config.jsonï¼‰ |
| `--urls "url1,url2"` | ä¸´æ—¶è¦†ç›– URLs |
| `--clean` | æ¸…ç†æ„å»ºäº§ç‰© |
| `--parallel` | å¹¶è¡Œæ„å»ºæ‰€æœ‰å¹³å°ï¼ˆä»…ç”¨äº `all`ï¼‰ |
| `--verify` | æ„å»ºåéªŒè¯äº§ç‰© |
| `--help` | æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯ |

### å¹³å°

- `ios` - æ„å»º iOS framework
- `macos` - æ„å»º macOS library
- `android` - æ„å»º Android AAR
- `harmony` - æ›´æ–° HarmonyOS é…ç½®
- `all` - æ„å»ºæ‰€æœ‰å¹³å°

---

## âš¡ å¹¶å‘æ£€æµ‹è¯´æ˜

å¹¶å‘æ£€æµ‹æ˜¯ v2.1 æ–°å¢çš„åŠŸèƒ½ï¼Œå¯ä»¥æ˜¾è‘—æå‡æ£€æµ‹é€Ÿåº¦ï¼š

### æ€§èƒ½å¯¹æ¯”

å‡è®¾ 10 ä¸ª URLï¼Œæ¯ä¸ªæ£€æµ‹éœ€è¦ 2 ç§’ï¼š

| æ¨¡å¼ | æ—¶é—´ | æå‡ |
|------|------|------|
| ä¸²è¡Œ | 20ç§’ | - |
| å¹¶å‘3ä¸ª | 8ç§’ | **2.5å€** |
| å¹¶å‘5ä¸ª | 4ç§’ | **5å€** |

### æ¨èé…ç½®

| åœºæ™¯ | `concurrent_check_count` | è¯´æ˜ |
|------|--------------------------|------|
| ç§»åŠ¨è®¾å¤‡ | 2-3 | èŠ‚çœæµé‡å’Œç”µé‡ |
| WiFi ç¯å¢ƒ | 3-5 | å¹³è¡¡é€Ÿåº¦å’Œèµ„æº |
| PC/æœåŠ¡å™¨ | 5-10 | å¿«é€Ÿæ‰¾åˆ°å¯ç”¨æœåŠ¡å™¨ |

### é‡è¦æç¤º

- âš ï¸ **File ç±»å‹ä¸å»ºè®®å¹¶å‘**ï¼ˆ`file_method_concurrent: false`ï¼‰
  - File ç±»å‹ä¼šé€’å½’ä¸‹è½½å­åˆ—è¡¨
  - å¹¶å‘å¯èƒ½å¯¼è‡´é€’å½’çˆ†ç‚¸ï¼ˆ3ä¸ªå¹¶å‘ Ã— 10ä¸ªå­URL = 30ä¸ªå¹¶å‘ï¼‰
  - ä¿æŒ `false` å¯é¿å…æ­¤é—®é¢˜

---

## ğŸ“¦ æ„å»ºäº§ç‰©

### iOS/macOS
```
ios-macos/.build/release/
â”œâ”€â”€ PassGFW (framework)
â””â”€â”€ PassGFWExample
```

### Android
```
android/passgfw/build/outputs/aar/
â””â”€â”€ passgfw-release.aar

android/app/build/outputs/apk/debug/
â””â”€â”€ app-debug.apk (æµ‹è¯•åº”ç”¨)
```

### HarmonyOS
```
harmony/entry/build/default/outputs/default/
â””â”€â”€ entry-default-signed.hap
```

---

## ğŸ› æ•…éšœæ’é™¤

### 1. æ„å»ºå¤±è´¥

**é—®é¢˜**: `BUILD FAILED`

**è§£å†³**:
```bash
# æ¸…ç†å¹¶é‡æ–°æ„å»º
./build.sh <platform> --clean
./build.sh <platform>
```

### 2. å…¬é’¥æœªæ‰¾åˆ°

**é—®é¢˜**: `Public key not found`

**è§£å†³**:
```bash
# è„šæœ¬ä¼šè‡ªåŠ¨ç”Ÿæˆ RSA å¯†é’¥å¯¹
# æˆ–æ‰‹åŠ¨æŒ‡å®šå…¬é’¥è·¯å¾„ï¼š
./build.sh ios --config my_config.json
```

### 3. æƒé™é—®é¢˜

**é—®é¢˜**: `Permission denied`

**è§£å†³**:
```bash
chmod +x build.sh
chmod +x build_interactive.sh
```

---

## ğŸ“š æ›´å¤šä¿¡æ¯

- **æºä»£ç **: `build.sh` (ä¸»æ„å»ºè„šæœ¬)
- **äº¤äº’å¼å·¥å…·**: `build_interactive.sh` (æ–°æ‰‹å‹å¥½)
- **é»˜è®¤é…ç½®**: `build_config.json`
- **ç‰ˆæœ¬**: v2.1.0

---

## ğŸ‰ æ›´æ–°æ—¥å¿—

### v2.1.0 (2025-01-XX)
- âœ¨ æ–°å¢äº¤äº’å¼æ„å»ºå·¥å…·
- âš¡ æ”¯æŒå¹¶å‘æ£€æµ‹é…ç½®
- ğŸ’¾ æ”¯æŒä¿å­˜è‡ªå®šä¹‰é…ç½®
- ğŸ¨ æ”¹è¿›ç”¨æˆ·ç•Œé¢

### v2.0.0 (2025-01-XX)
- ğŸš€ åˆå§‹ç‰ˆæœ¬
- æ”¯æŒå¤šå¹³å°æ„å»º
- æ”¯æŒé…ç½®æ–‡ä»¶
